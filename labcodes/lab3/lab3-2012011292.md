## lab3实验报告
### 2012011292 王子寒

注：本实验代码所在gitserver网址为 [github] [gitlab] 

#### 练习1：给未被映射的地址映射上物理页
- 请描述页目录项（Pag Director Entry）和页表（Page Table Entry）中组成部分对ucore实现页替换算法的潜在用处。

    > 首先毫无疑问页目录项和页表组成的页机制使得页替换算法成为了可能。  
    > 之后，具体的，页表项内容中存储的标志位，比如引用位、修改位，可供页替换算法使用，使得页替换能够变得更加全面高效。

- 如果ucore的缺页服务例程在执行过程中访问内存，出现了页访问异常，请问硬件要做哪些事情？

    > 硬件上，首先CPU会把产生异常的线性地址存储在CR2寄存器中。  
    > 之后，CPU在当前内核栈保存当前被打断的程序现场，即依次压入当前被打断程序使用的EFLAGS，CS，EIP，errorCode。  
    > 最后，CPU会把页访问异常中断号0xE对应的中断服务例程的地址加载到CS和EIP寄存器中，开始执行中断服务例程。

#### 练习2：补充完成基于FIFO的页面替换算法
- 如果要在ucore上实现"extended clock页替换算法"请给你的设计方案，现有的swap_manager框架是否足以支持在ucore中实现此算法？如果是，请给你的设计方案。如果不是，请给出你的新的扩展和基此扩展的设计方案。

    > 个人觉得目前的swap_manager框架已经足以支持在ucore中实现extended clock算法。  
    > extended clock算法，在map时与fifo没有区别，均是环形链表结构，并且新调入的页置于队列尾。  
    > 其主要区别在于swap_out的时候，extended clock算法只要进行多次的轮循，就可以找到合适淘汰的页进行换出。在框架上并没有要求更多。

- 需要被换出的页的特征是什么？

    > 需要被换出的页主要由页表项内容中的两个特征进行判断：引用位和修改位。  
    > 其中，未曾被引用也未曾被修改的页面将被换出，但在优先度的选择上，引用高于修改。  
    > 即对于未曾被引用的换出优先度高度被引用过的页，若两者都被引用或未曾引用过，再判断修改位。

- 在ucore中如何判断具有这样特征的页？

    > 需要对页表项的内容中的标志位进行判断，即Page数据结构的flags中的某位进行判断。  
    > 若有必要，需要在flags中增加相应的引用位或者修改位。

- 何时进行换入和换出操作？

    > 当某一进程在申请新的页时，物理内存空间已经没有足够的剩余空间时，将进行页换入和换出操作。

##### 实验感想：
> 本次实验代码并不是十分的困难，可能是因为正好到了期中考试了吧~
> 页异常处理的实现，代码中给足了提示；而FIFO页替换算法的实现也相当简单。
> 我似乎也有些明白老师所说的“lab1和lab2才是最难最关键”的意思了，当打下基础理解框架后，问题与代码本身其实确实算不上大问题。

[github]:https://github.com/thu011292/ucore_lab.git
[gitlab]:http://south.cs.tsinghua.edu.cn/thu011292/ucore_lab.git
